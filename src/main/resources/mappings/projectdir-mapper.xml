<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ProjectDirDAO">
	<!-- 프로젝트 생성 맵 -->
	<resultMap type="projectdir" id="projectdir">
		<id property="projectnum" column="PROJECTNUM"/>
		<result property="projectname" column="PROJECTNAME" />
		<result property="projectcontent" column="PROJECTCONTENT" />
		<result property="projecttype" column="PROJECTTYPE" />
		<result property="createdate" column="CREATEDATE"/>
		<result property="usernum" column="USERNUM"/>
		<collection property="project_lookup" resultMap="project_lookup"></collection>
	</resultMap>
	
	<!-- 프로젝트 조회 맵 -->
	<resultMap type="projectlookup" id="projectlookup">
		<id property="lookupnum" column="LOOKUPNUM"/>
		<result property="projectname" column="PROJECTNAME"/>
		<result property="username" column="USERNAME"/>
		<result property="projectmanager" column="PROJECTMANAGER" />
		<result property="joindate" column="JOINDATE"/>
	</resultMap>
	
	<!-- 프로젝트 생성 -->	
	<insert id="projectDirInsert" parameterType="projectdir">
		INSERT INTO projectdir (projectnum, projectname, projectcontent, projecttype)
		VALUES((select nvl(max(projectnum), 0) +1 from projectdir), #{projectname}, #{projectcontent}, #{projecttype})
	</insert>
	
	<insert id="projectLookup" parameterType="projectlookup">
		INSERT INTO projectlookup (lookupnum, projectname, username, projectmanager)
		VALUES((select nvl(max(lookupnum), 0) +1 from projectlookup), #{projectname}, #{username}, #{projectmanager})
	</insert> 
	
	<!-- 프로젝트 및 사용자 테이블 -->
	
	<!-- 프로젝트 리스트 -->
	
	<!-- 프로젝트 리스트 출력 기본	WHERE 프로젝트 참여자로 바꿔야 함  -->
	<select id="getProjectDirList" resultType="projectdir" parameterType="projectdir">
		SELECT * FROM projectlookup look LEFT JOIN projectdir dir ON look.projectname = dir.projectname WHERE look.username = #{username} <!-- ORDER BY dir.projectnum DESC -->
	</select>
	
	
	<select id="getProjectDirTotal" resultType="projectlookup" parameterType="projectlookup">
		SELECT * FROM projectlookup WHERE username = dnjswhdzld
	</select>
	
	
	<select id="getProjectDirAscending" resultType="projectlookup" parameterType="projectlookup">
		SELECT * FROM projectlookup WHERE projectmanager = #{projectmanager} ORDER BY projectname ASC
	</select>
	
	<select id="getProjectDirDescending" resultType="projectdir" parameterType="projectdir">
		SELECT * FROM projectdir WHERE projectmanager = #{projectmanager} ORDER BY projectname DESC
	</select>
	
	
</mapper>
