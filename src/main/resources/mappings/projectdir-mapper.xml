<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ProjectDirDAO">
	<!-- 프로젝트 생성 맵 -->
	<resultMap type="projectdir" id="projectdir">
		<id property="projectnum" column="PROJECTNUM"/>
		<result property="projectname" column="PROJECTNAME" />
		<result property="projectcontent" column="PROJECTCONTENT" />
		<result property="projecttype" column="PROJECTTYPE" />
		<result property="createdate" column="CREATEDATE"/>
		<collection property="project_lookup" resultMap="project_lookup"></collection>
	</resultMap>
	
	<!-- 프로젝트 생성 -->	
	<insert id="projectDirInsert" parameterType="projectdir">
		INSERT INTO projectdir (projectnum, projectname, projectcontent, projecttype)
		VALUES((select nvl(max(projectnum), 0) +1 from projectdir), #{projectname}, #{projectcontent}, #{projecttype})
	</insert>
	
	
	<!-- 프로젝트 및 사용자 테이블 -->
	
	<!-- 프로젝트 리스트 -->
	
	<!-- 프로젝트 리스트 출력 기본	WHERE 프로젝트 참여자로 바꿔야 함  -->
	<select id="getProjectDirTotalList" resultType="projectdir" parameterType="projectdir">
		SELECT * FROM projectdir INNER JOIN projectlookup ON projectdir.projectname = projectlookup.projectname 
		WHERE username = #{username} ORDER BY projectnum DESC
	</select>
	
	
	<select id="getProjectDirManagerList" resultType="projectdir" parameterType="projectdir">
		SELECT * FROM projectdir INNER JOIN projectlookup ON projectdir.projectname = projectlookup.projectname 
		WHERE username = #{username} and projectmanager = 1
	</select>
	
	
</mapper>
